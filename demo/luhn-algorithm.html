<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
        <meta name="HandheldFriendly" content="True">

        <!-- add to homescreen for Chrome on Android -->
        <meta name="mobile-web-app-capable" content="yes">
        <link rel="icon" sizes="192x192" href="/logo.jpg">

        <!-- add to homescreen for Safari on iOS -->
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-title" content="Luhn Algorithm | Matthew Grove">
        <link rel="apple-touch-icon-precomposed" href="/logo.jpg">

        <!-- tile icon & colour for Windows 8 -->
        <meta name="msapplication-TileImage" content="/logo.jpg">
        <meta name="msapplication-TileColor" content="#d84315">

        <title>Luhn Algorithm | Matthew Grove</title>
        <meta name="description" content="Replication of the Luhn Algorithm - by Matthew Grove">
        <link rel="icon" href="/logo.jpg">

        <!-- import Roboto (font) -->
        <link href="/assets/roboto.css" rel="stylesheet">

        <!-- import jQuery -->
        <script src="/assets/jquery.min.js"></script>

        <!-- import Material Design components & icons -->
        <link rel="stylesheet" type="text/css" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
        rel="stylesheet">
        <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>

        <style>
            /* change material design theme */
            :root {
                --mdc-theme-primary: #00838f;
                --mdc-theme-secondary: #d84315;
            }
            .mdc-text-field--focused:not(.mdc-text-field--disabled) .mdc-floating-label {
                color: var(--mdc-theme-primary);
            }
            .mdc-fab {
                background-color: var(--mdc-theme-secondary);
            }

            /* hide unwanted overflow from mdc-text-field :before & :after */
            .mdc-text-field-container {
                overflow: hidden;
            }
            /* give space for mdc-text-field label to show properly when field is selected */
            .mdc-text-field {
                margin-top: 5px;
            }

            body {
                font-family: 'Roboto', sans-serif;
                text-align: center;
            }
            .mdc-text-field-helper-text {
                margin-bottom: 10px;
            }
            .source-code-link {
                position: fixed;
                bottom: 15px;
                right: 15px;
            }

            body {
                display: flex;
                height: 100vh;
            }
        </style>

    </head>
    <body>
        <aside class="mdc-drawer" data-mdc-auto-init="MDCDrawer">
            <div class="mdc-drawer__content">
                <nav class="mdc-list">
                    <a class="mdc-list-item mdc-list-item--activated" href="#" aria-selected="true">
                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i>
                        <span class="mdc-list-item__text">Inbox</span>
                    </a>
                    <a class="mdc-list-item" href="#">
                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">send</i>
                        <span class="mdc-list-item__text">Outgoing</span>
                    </a>
                    <a class="mdc-list-item" href="#">
                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">drafts</i>
                        <span class="mdc-list-item__text">Drafts</span>
                    </a>
                </nav>
            </div>
        </aside>
        <h1>Luhn Algorithm</h1>
        <header class="mdc-top-app-bar" data-mdc-auto-init="MDCTopAppBar">
            <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                    <a href="#" class="material-icons mdc-top-app-bar__navigation-icon">menu</a>
                    <span class="mdc-top-app-bar__title">Luhn Algorithm</span>
                </section>
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end">
                    <a href="#" class="material-icons mdc-top-app-bar__navigation-icon" aria-label="My Blog">home</a>
                </section>
            </div>
        </header>
        <main>
            <!-- input field (in container so that unwanted overflow from :before & :after is hidden) -->
            <div class="mdc-text-field-container">
                <div class="mdc-text-field mdc-text-field--outlined" data-mdc-auto-init="MDCTextField">
                  <input type="number" id="tf-outlined" class="mdc-text-field__input">
                  <label for="tf-outlined" class="mdc-floating-label ">Your Number</label>
                  <div class="mdc-notched-outline">
                    <svg>
                      <path class="mdc-notched-outline__path"/>
                    </svg>
                  </div>
                  <div class="mdc-notched-outline__idle"></div>
                </div>
            </div>
            <!-- input field helper text -->
            <p class="mdc-text-field-helper-text" aria-hidden="true">
              Validate with the Luhn Algorithm
            </p>
            <!-- button to submit & check number with Luhn algorithm -->
            <button class="validation_button mdc-button mdc-button--outlined"  data-mdc-auto-init="MDCRipple" onclick="checkNumber()">
              <i class="material-icons mdc-button__icon">check_circle_outline</i>
              Check
            </button>
            <!-- displays evaluation of number by Luhn algorithm -->
            <p id="validation_message"></p>

            <!-- link to source code on GitHub -->
            <a href="https://github.com/mgrove36/mgrove36.github.io/blob/master/demo/luhn-algorithm.html" class="source-code-link mdc-fab mdc-fab--extended" data-mdc-auto-init="MDCRipple">
                <span class="material-icons mdc-fab__icon">rate_review</span>
                <span class="mdc-fab__label">View on GitHub</span>
            </a>
        </main>
    </body>
    <script>
        // include navbar
        $(function(){
            $("#nav-placeholder").load("nav.html");
        });

        // initiate material design animations
        mdc.autoInit();

        document.addEventListener("keyup", function(event) {
            // stop any code that may normally run when enter key pressed
            event.preventDefault();
            // if enter key is pressed, run Luhn algorithm
            if (event.keyCode === 13) {
                checkNumber();
            } else {
                // if number in input field is being edited, remove previous number evaluation message
                document.getElementById("validation_message").innerHTML = null;
            }
        });

        // function for adding all the digits
        function sumDigits(total,digit) {
            return total + digit;
        }

        // function for validating number entered with Luhn algorithm
        function checkNumber() {
            // reverse digits in number
            var digits = String(document.getElementsByTagName("input")[0].value).split("");
            digits = digits.reverse();
            // makes sure only every other digit (counting from the right) is doubled
            var startingIndex = (digits.length % 2 == 0) ? 0 : 1;
            // doubles every other digit
            for (var i = startingIndex; i < digits.length; i += 2) {
                var newDigit = Number(digits[i]) * 2;
                // if doubled digit is two digits, add them
                while (newDigit > 9) {
                    var newDigits = String(newDigit).split("");
                    newDigit = 0;
                    newDigits.forEach(function(item) {
                        newDigit += Number(item);
                    });
                }
                // replace old digit with new one
                digits[i] = newDigit;
            }
            // convert all digits to numbers (some were strings)
            digits.forEach(function(item, index) {
                digits[index] = Number(item);
            });
            // sum the digits
            var sum = digits.reduce(sumDigits);
            // check if number is valid by moduloing it by 10
            switch (sum % 10 == 0) {
                // display appropriate evaluation message on page
                case true:
                    document.getElementById("validation_message").innerHTML = "Number is valid";
                    break;
                case false:
                    document.getElementById("validation_message").innerHTML = "Number is invalid";
                    break;
            }
        }
   </script>
</html>
