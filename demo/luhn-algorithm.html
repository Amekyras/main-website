<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">

        <title>Luhn Algorithm | Matthew Grove</title>
        <meta name="description" content="Replication of the Luhn Algorithm - by Matthew Grove">
        <link rel="icon" href="/logo.jpg">
        <link href="/assets/roboto.css" rel="stylesheet">

        <!-- Import Material Design Components & Icons -->
        <link rel="stylesheet" type="text/css" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
        rel="stylesheet">
        <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>

        <style>
            /* change material design theme */
            :root {
                --mdc-theme-primary: #d84315;
                --mdc-theme-secondary: #00838f;
            }
            .mdc-text-field--focused:not(.mdc-text-field--disabled) .mdc-floating-label {
                color: var(--mdc-theme-primary);
            }

            body {
                font-family: 'Roboto', sans-serif;
                text-align: center;
            }
            .mdc-text-field-helper-text {
                margin-bottom: 10px;
            }
        </style>

    </head>
    <body>
        <h1>Luhn Algorithm</h1>
        <div class="mdc-text-field mdc-text-field--outlined" data-mdc-auto-init="MDCTextField">
          <input type="text" id="tf-outlined" class="mdc-text-field__input">
          <label for="tf-outlined" class="mdc-floating-label ">Your Number</label>
          <div class="mdc-notched-outline">
            <svg>
              <path class="mdc-notched-outline__path"/>
            </svg>
          </div>
          <div class="mdc-notched-outline__idle"></div>
        </div>
        <p class="mdc-text-field-helper-text" aria-hidden="true">
          Validate with the Luhn Algorithm
        </p>
        <button type="submit" class="validation_button mdc-button mdc-button--outlined"  data-mdc-auto-init="MDCRipple" onclick="checkNumber()">
          <i class="material-icons mdc-button__icon">check_circle_outline</i>
          Check
        </button>
        <p id="validation_message"></p>
    </body>
    <script>
        // initiate material design animations
        mdc.autoInit();

        document.addEventListener("keyup", function(event) {
            event.preventDefault();
            if (event.keyCode === 13) {
                checkNumber();
            } else {
                document.getElementById("validation_message").innerHTML = null;
            }
        });

        function checkNumber() {
            var digits = String(document.getElementsByTagName("input")[0].value).split("");
            digits = digits.reverse();
            var startingIndex = (digits.length % 2 == 0) ? 0 : 1;
            for (var i = startingIndex; i < digits.length; i += 2) {
                var newDigit = Number(digits[i]) * 2;
                while (newDigit > 9) {
                    var newDigits = String(newDigit).split("");
                    newDigit = 0;
                    newDigits.forEach(function(item) {
                        newDigit += Number(item);
                    });
                }
                digits[i] = newDigit;
            }
            digits.forEach(function(item, index) {
                digits[index] = Number(item);
            });
            function sumDigits(total,digit) {
                return total + digit;
            }
            var sum = digits.reduce(sumDigits);
            switch (sum % 10 == 0) {
                case true:
                    document.getElementById("validation_message").innerHTML = "Number is valid";
                    break;
                case false:
                    document.getElementById("validation_message").innerHTML = "Number is invalid";
                    break;
            }
        }
   </script>
</html>
